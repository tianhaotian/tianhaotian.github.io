<!DOCTYPE html>



  


<html class="theme-next gemini use-motion" lang="zh-Hans">
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT">










<meta property="og:type" content="website">
<meta property="og:title" content="Hexo">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Hexo">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Gemini',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/">





  <title>Hexo</title>
  








</head>

<body itemscope="" itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope="" itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Hexo</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            归档
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/10/29/postgis建表问题/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Frodle Tim">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/10/29/postgis建表问题/" itemprop="url">记一次GIS数据上传到PostGis的问题</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-10-29T15:39:59+08:00">
                2019-10-29
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2019/10/29/postgis建表问题/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2019/10/29/postgis建表问题/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="记录一次GIS上传报错问题排查"><a href="#记录一次GIS上传报错问题排查" class="headerlink" title="记录一次GIS上传报错问题排查"></a>记录一次GIS上传报错问题排查</h3><h5 id="现象：上传卡在了PostGis建完表写数据时，会报表找不到，然后报错，实际建表时并没有报错"><a href="#现象：上传卡在了PostGis建完表写数据时，会报表找不到，然后报错，实际建表时并没有报错" class="headerlink" title="现象：上传卡在了PostGis建完表写数据时，会报表找不到，然后报错，实际建表时并没有报错"></a>现象：上传卡在了PostGis建完表写数据时，会报表找不到，然后报错，实际建表时并没有报错</h5><p><strong>初步排查</strong>：通过报不存在的表名gisp_upload_c4a95ec8e8452135eb5a5ba7e6487585_1572330097034_5411_polygon去查PostGis发现确实没有这个表，但是查到了gisp_upload_c4a95ec8e8452135eb5a5ba7e6487585_1572330097034_5411这张表，而对应名称是没有改多图层上面之前的命名规则（新的规则在表名后面加了_图层类型），于是怀疑业务逻辑中可能哪里没有改全，于是开始debug上传的业务代码</p>
<p><img src="/2019/10/29/postgis建表问题/image-20191029151727889.png" alt="image-20191029151727889"></p>
<p><img src="/2019/10/29/postgis建表问题/image-20191029151850991.png" alt="image-20191029151850991"></p>
<p><img src="/2019/10/29/postgis建表问题/image-20191029151937843.png" alt="image-20191029151937843"></p>
<p>debug到了建表SQL，发现并没有问题，继续往下走，等execute完直接查库</p>
<p><img src="/2019/10/29/postgis建表问题/image-20191029152157183.png" alt="image-20191029152157183"></p>
<p>建表的SQL对了，但是表名确实不对，于是复制建表SQL在客户端直接执行</p>
<p><img src="/2019/10/29/postgis建表问题/image-20191029152728163.png" alt="image-20191029152728163"></p>
<p>发现是Postgre把表名给改了….问题找到了</p>
<p><strong>定位并解决</strong></p>
<p>PostgreSQL 表名有限制，长度为NAMEDATALEN（一般为64）</p>
<p>The system uses no more than NAMEDATALEN-1 characters of an identifier; longer names can be written in commands, but they will be truncated. By default, NAMEDATALEN is 64 so the maximum identifier length is 63 (but at the time PostgreSQL is built, NAMEDATALEN can be changed in src/include/postgres_ext.h).</p>
<p>From <a href="https://www.postgresql.org/docs/7.3/sql-syntax.html" target="_blank" rel="noopener">https://www.postgresql.org/docs/7.3/sql-syntax.html</a></p>
<p><strong>注意执行SQL时，Postgre不会报错！！！但是会报出Notice，然后执行truncated后的SQL</strong><br>NOTICE:  identifier “gisp_upload_c4a95ec8e8452135eb5a5ba7e6487585_1572330097034_5411_polygon” will be truncated to “gisp_upload_c4a95ec8e8452135eb5a5ba7e6487585_1572330097034_5411”</p>
<p>旧的表命名规则：gisp_upload_32位用户id_13位时间戳_4位随机数，总位数刚好是63（64-1长度）…..新的规则又在基础上加了6~12位不等，超过了最大长度会只保留到最大长度位</p>
<p>最终修改命名规则：</p>
<p>gisp_upload_16位用户id_10位时间戳_4位随机数_10位内的点线面标识，最大长度55位</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/09/06/tornado接收参数只是string/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Frodle Tim">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/09/06/tornado接收参数只是string/" itemprop="url">请求参数不支持数值</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-09-06T15:10:31+08:00">
                2019-09-06
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2019/09/06/tornado接收参数只是string/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2019/09/06/tornado接收参数只是string/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="Tornado剖析"><a href="#Tornado剖析" class="headerlink" title="Tornado剖析"></a>Tornado剖析</h2><h4 id="Q-为什么解析的参数格式只有string，而无法区分出int"><a href="#Q-为什么解析的参数格式只有string，而无法区分出int" class="headerlink" title="Q: 为什么解析的参数格式只有string，而无法区分出int"></a>Q: 为什么解析的参数格式只有string，而无法区分出int</h4><p>背景：前端传参通过form，fe转发需要把form表单转成raw_body的json字符串，转发给gis的后端服务，gis后端服务里面报错发现fe转发中的传参中，数字和字符都是字符串，而kotlin类型无法string转interger所以报错，这里调研了一下能否看框架参数能否支持到默认转发时保留不同类型</p>
<p>类tornado.web.RequestHandler维持了request变量（tornado.httputil.HTTPServerRequest类）<br>这个request变量中维护了arguments、body_arguments以及body三个属性，前两个是格式化的参数字典结构，后一个从请求中直接读出来的body string</p>
<p>request对象的初始化在tornado.routing._RoutingDelegate类中进行实例化，这里有个比较有趣的点，实例化request的方法是_RoutingDelegate.headers_received，而调度headers_received的模式实际上用yield关键字生成Future，使tornado.gen.Runner这个类异步调用了tornado.http1util.HTTP1Connection中方法_read_message，而tornado.gen.Runner是tornado中异步处理的核心类，同时也是Future对象的执行类，通过执行generator的send方法不断异步执行，最后set_result返回Future，这个设涉及到的就是tornado.gen模块如何异步切换请求上下文以及执行Future对象</p>
<p>_RoutingDelegate类中会对应使用data_received方法把body中的字节数据放入request结构中，依然是异步调度到Runner后，Runner在执行过程中调度tornado.http1util.HTTP1Connection的_read_fixed_body方法，读取数据就是直接对应到Request类的body属性中，类似于URL中的form格式存储</p>
<p>这里顺便提一下读取Header和Body的过程，Tornado使用tornado.iostream.IOStream处理套接字和IO操作，这个类实现非阻塞的socket读写操作，实现非阻塞依然是通过方法返回Future对象，然后ioloop到Runner中最后执行，这里不再详细解释具体每个不同的方法的特征和作用</p>
<p>通过IOStream非阻塞读取，最后回调_RoutingDelegate的data_received，写入body后再执行_RoutingDelegate的finish，更新request的arguments、body_arguments，真正的执行过程中，还涉及到_HandlerDelegate这个类，其实在整个请求的生命周期中，tornado会根据不同的阶段生成不同的Delegate类去处理，_RoutingDelegate是路由派发的实例化入口，也是异步调度的实例化入口，_RoutingDelegate会调度_HandlerDelegate这个类，去做真正的request的改动，最后处理到业务级别RequestHandler，所以实质上是_HandlerDelegate去修改request中的属性，在finish中，调用request的_parse_body方法，最终调用到parse_qsl这个方法，这个方法是用标准格式去切分body字符的，所以split出来的最终都是string格式，无法解析出int</p>
<p>在debug过程中，实际发现tornado在调度_RoutingDelegate和IOStream做IO时都会使用yield异步调度Future对象，最后set_result以及callback，也就是异步框架的体现</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/09/06/hello-world/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Frodle Tim">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/09/06/hello-world/" itemprop="url">Hello World</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-09-06T15:03:40+08:00">
                2019-09-06
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2019/09/06/hello-world/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2019/09/06/hello-world/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>Welcome to <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/" target="_blank" rel="noopener">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html" target="_blank" rel="noopener">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues" target="_blank" rel="noopener">GitHub</a>.</p>
<h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">"My New Post"</span></span><br></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/writing.html" target="_blank" rel="noopener">Writing</a></p>
<h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/server.html" target="_blank" rel="noopener">Server</a></p>
<h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/generating.html" target="_blank" rel="noopener">Generating</a></p>
<h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/deployment.html" target="_blank" rel="noopener">Deployment</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/05/29/problem-0522/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Frodle Tim">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/05/29/problem-0522/" itemprop="url">记录一次需求开发的坑（表格列总计新增计算方式）</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-05-29T11:49:03+08:00">
                2019-05-29
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2019/05/29/problem-0522/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2019/05/29/problem-0522/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>开发两个自定义聚合函数 MAX_TO_VALUE OR MIN_TO_VALUE</p>
<h2 id="Problem-1-UDAF依赖class不对的问题"><a href="#Problem-1-UDAF依赖class不对的问题" class="headerlink" title="Problem 1: UDAF依赖class不对的问题"></a>Problem 1: UDAF依赖class不对的问题</h2><p>开发完成联调时发现执行SQL时，旧函数BOL指向的Java class不对</p>
<h3 id="定位以及解决"><a href="#定位以及解决" class="headerlink" title="定位以及解决"></a>定位以及解决</h3><p>Scala的Server程序会在启动时注册一遍所有UDF和UDAF，对于已经create过的函数将不会重复register，而开发中，发现BOL这个之前的函数对应的class命名不规范，修改了之前的class类名，而增加的MAX_TO_VALUE对应的class则用了之前函数的class，初始化时，BOL已经被创建了，指向的class不变，而由于实际上class名称已经被修改，所以出现了指向错误问题。</p>
<p>解决: 在Hive中删除之前已注册过的函数，重启Server，重新注册UDF后解决</p>
<h2 id="Problem-2-新增UDAF运行结果一直为Null"><a href="#Problem-2-新增UDAF运行结果一直为Null" class="headerlink" title="Problem 2: 新增UDAF运行结果一直为Null"></a>Problem 2: 新增UDAF运行结果一直为Null</h2><p>PostMan模拟请求时，MAX_TO_VALUE结果一直是空</p>
<h3 id="定位以及解决-1"><a href="#定位以及解决-1" class="headerlink" title="定位以及解决"></a>定位以及解决</h3><p>Debug模式运行Server，断点调试发现UDAF在iterate和terminatePartial完成后，merge的时候传入的数据结构SimpleNormalValue的outputVal一直是null，而在iterate阶段是确认有值的，后续跟踪断点发现terminatePartial-&gt;merge的过程中，hive使用了Java反射去传递SimpleNormalValue这个类的结构，而SimpleNormalValue是从SimpleValue继承过来的，父类中的protected类型的变量outputVal对于子类是private类型，反射是获取不到private的变量</p>
<p>解决: 声明从protected变为public，或者不继承outputVal而是重新声明子类的outputVal</p>
<h2 id="Problem-3-含对比时计算结果不对"><a href="#Problem-3-含对比时计算结果不对" class="headerlink" title="Problem 3: 含对比时计算结果不对"></a>Problem 3: 含对比时计算结果不对</h2><p>有对比维度时，表格统计的值预期是(3,null,null)，实际为(3,3,3)</p>
<h3 id="定位以及解决-2"><a href="#定位以及解决-2" class="headerlink" title="定位以及解决"></a>定位以及解决</h3><p>包含对比时，查询的原始表的维度中包含了对比维度，另外结果集是用临时表做if判断然后再聚合的结果，因此实际表数据中没有的空记录，会被展示到查询结果里面，而列总计统计的是原始表的数据，而非结果数据或临时表数据（因为要统计limit之前的数据），另外对原始数据的维度idx计算也不准确</p>
<p>解决: 修复原始数据维度idx偏移的问题</p>
<p>TODO: 后续把包含对比列总计的逻辑，从直接对原始表进行GROUP SET分类聚合，改造为对对比拆分后的临时表进行GROUP SET分类聚合，改造工作大致有几点：1.临时表的维度不包含对比，因此GROUP SET需要包含空，且一个数值要根据xy_fields结构拆分成多列，同理在处理列总计查询到的数据时，之前的分类聚合是对不同对比做拆分的，而后续结果是要根据数值idx在拆分; 2.包含TOP的时候是Join了结果表和原始表，需要改造为Join结果表和临时表; 3.包含高级计算（同环比）时，注意兼容之前为了处理高级计算列总计的相关开发</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/03/02/gdb调试运行中进程/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Frodle Tim">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/03/02/gdb调试运行中进程/" itemprop="url">gdb调试运行中进程</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-03-02T16:57:24+08:00">
                2019-03-02
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2019/03/02/gdb调试运行中进程/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2019/03/02/gdb调试运行中进程/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <blockquote>
<p>安装Python调试环境: <a href="https://wiki.python.org/moin/DebuggingWithGdb" target="_blank" rel="noopener">https://wiki.python.org/moin/DebuggingWithGdb</a></p>
</blockquote>
<h2 id="常用GDB命令"><a href="#常用GDB命令" class="headerlink" title="常用GDB命令"></a>常用GDB命令</h2><ol>
<li>gdb原生命令<ol>
<li><code>bt</code> 显示当前线程C部分调用栈</li>
<li><code>list</code> 示当前线程的C代码执行位置</li>
<li><code>info threads</code> 显示当前进程中的所有线程</li>
<li><code>thread apply {ID} {command}</code> 在线程{ID}上执行命令, 默认命令在1号线程执行</li>
<li><code>print</code> 打印C变量值</li>
<li><code>up</code> 返回C部分调用者</li>
<li><code>down</code> 进入C部分函数调用</li>
</ol>
</li>
<li>Python扩展命令 <ol>
<li><code>py-bt</code> 显示当前线程Python部分调用栈</li>
<li><code>py-list</code> 显示当前线程的Python代码执行位置</li>
<li><code>py-locals</code> 获取当前局部变量的值</li>
<li><code>py-print</code> 打印某个变量的值</li>
<li><code>py-up</code> 返回Python部分调用者</li>
<li><code>py-down</code> 进入Python部分函数调用</li>
</ol>
</li>
</ol>
<h2 id="常用Linux命令"><a href="#常用Linux命令" class="headerlink" title="常用Linux命令"></a>常用Linux命令</h2><ol>
<li><code>strace -p {PID}</code> 跟踪指定进程的系统调用情况</li>
<li><code>lslocks</code> 列出当前系统中的文件锁情况</li>
<li><code>fuser {file}</code> 列出打开该文件的进程ID</li>
</ol>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  


          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">Frodle Tim</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">5</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            

            

          </nav>

          

          

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Frodle Tim</span>

  
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Gemini</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  

    
      <script id="dsq-count-scr" src="https://tianhaotian.disqus.com/count.js" async></script>
    

    

  




	





  












  <script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
  <script src="//unpkg.com/valine/dist/Valine.min.js"></script>
  
  <script type="text/javascript">
    var GUEST = ['nick','mail','link'];
    var guest = 'nick,mail,link';
    guest = guest.split(',').filter(item=>{
      return GUEST.indexOf(item)>-1;
    });
    new Valine({
        el: '#comments' ,
        verify: false,
        notify: false,
        appId: 'HG7On1dDpIgn5bjeqMqzSqx7-gzGzoHsz',
        appKey: 'GDRbP4lxFrqUQJUXq53cDnOt',
        placeholder: 'Just go go',
        avatar:'mm',
        guest_info:guest,
        pageSize:'10' || 10,
    });
  </script>



  





  

  

  

  
  

  

  

  

</body>
</html>
